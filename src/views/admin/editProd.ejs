<!DOCTYPE html>
<html lang="es">
<%- include('../partials/head.ejs') %>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

  <body>
    <%- include('../partials/header.ejs') %>
      <%- include ('../partials/nav.ejs') %>

        <main class="edit">
          
          <h3 class="h3editprod">Estás editando el producto:<p class="produ-titulo"><%- product.name %></p></h3>

          <div class="formmain">
              <div class="formmain-create">
                <form class="col-md-9 ms-sm-auto col-lg-10 px-md-4 row p-3 justify-content-center" action="/admin/products/edit/<%= product.id %>?_method=PUT" method="POST" enctype="multipart/form-data">
                  <div class="col-12 col-md-6">
                        <div class="col-12 mb-3">
                            <label for="inputName" class="form-label">Nombre</label>
                            <input type="text" class="form-control" id="inputName" name="name" value="<%= locals.old ? old.name : product.name %>">
                            <% if (locals.errors && errors.name) { %>
                                <small class="text-danger"><%= errors.name.msg %> REQUERIDISIMO </small>
                            <% } %>
                        </div>


                        <div class="col-12 mb-3">
                            <label for="inputName" class="form-label">Marca</label>
                            <input type="text" class="form-control" id="inputBrand" name="brand" value="<%= locals.old ? old.brand : product.brand %>">
                            <% if (locals.errors && errors.name) { %>
                                <small class="text-danger"><%= errors.name.msg %> </small>
                            <% } %>
                        </div>

        
                        <div class="col-12 mb-3">
                            <select class="form-select categorySelect" id="specificSizeSelect" name="category">
                              <option selected hidden value="">Categorias</option>
                              <% categories.forEach(category => { %>
                                <option value="<%- category.id %>" <%- locals.old && old.category == category.id ? "selected" : category.id == product.category ? "selected" : "" %>><%- category.name %></option>
                             <% }) %>
                            </select>
                            <% if (locals.errors && errors.category) { %>
                                <small class="text-danger"><%= errors.category.msg %> </small>
                            <% } %>
                        </div>
                        <div class="col-12 mb-3">
                            <select class="form-select subcategorySelect" id="specificSizeSelect" name="subcategory">
                              <option selected hidden value="">Subcategorias</option>
                              <% subcategories.forEach(subcategory => { %>
                                <option value="<%- subcategory.id %>" <%= locals.old && old.subcategory.id == subcategory.id ? "selected" : ""  %> ><%- subcategory.name %> </option>
                                <% }) %>
                            </select>
                            <% if (locals.errors && errors.subcategory) { %>
                                <small class="text-danger"><%= errors.subcategory.msg %> </small>
                            <% } %>
                        </div>
                        <div class="col-12 mb-3">
                            <label for="inputPrice" class="form-label">Precio</label>
                            <input type="number" class="form-control" id="inputPrice" name="price" value="<%= locals.old ? old.price : product.price %>">
                            <% if (locals.errors && errors.price) { %>
                                <small class="text-danger"><%= errors.price.msg %> </small>
                            <% } %>
                        </div>
                    </div>
                    <div class="col-12 col-md-6">
                        <div class="col-12 mb-3">
                            <label for="inputDiscount" class="form-label">Descuento</label>
                            <input type="number" class="form-control" id="inputDiscount" name="discount" value="<%= locals.old ? old.discount : product.discount %>">
                            <% if (locals.errors && errors.discount) { %>
                                <small class="text-danger"><%= errors.discount.msg %> </small>
                            <% } %>
                        </div> 

                        <div class="col-12 mb-3">
                            <label for="inputDiscount" class="form-label">Cuotas</label>
                            <input type="number" class="form-control" id="inputCuotes" name="cuotes" value="<%= locals.old ? old.cuotes : product.cuotes %>">
                            <% if (locals.errors && errors.discount) { %>
                                <small class="text-danger"><%= errors.discount.msg %> </small>
                            <% } %>
                        </div> 

                        <div class="col-12 mb-3">
                            <label for="inputImage" class="form-label">Imagen</label>
                            <input type="file" name="image" class="form-control" aria-label="file example" id="inputImage" multiple>
                            <% if (locals.errors && errors.image) { %>
                                <small class="text-danger"><%= errors.image.msg %> </small>
                            <% } %>
                        </div>
                        <div class="col-12 mb-3">
                            <label for="validationTextarea" class="form-label">Descripción</label>
                            <textarea class="form-control" id="validationTextarea" name="description"> <%= locals.old ? old.description : product.description %> </textarea>
                            <% if (locals.errors && errors.description) { %>
                                <small class="text-danger"><%= errors.description.msg %> </small>
                            <% } %>
                        </div>
                    </div>
        
                    <button type="submit" class="btn btn-outline-primary col-3 mt-3">
                        CREAR
                    </button>
                </form>
                </div>
        </main>



        <%- include ('../partials/footer.ejs') %>
          <%- include ('../partials/scripts.ejs') %>
  </body>

</html>